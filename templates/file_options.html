{% extends "base.html" %}

{% block title %}
  Choose metrics for file
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">
    {% if source == "popular" %}
      Popular network: {{ title or filename }}
    {% else %}
      Uploaded file: {{ filename }}
    {% endif %}
  </h2>

  {% if description %}
    <p class="text-muted">{{ description }}</p>
  {% endif %}

  <p>
    <strong>Nodes (n):</strong> {{ n }}<br>
    <strong>Edges (m):</strong> {{ m }}
  </p>

  <hr>

  <form method="post" action="{{ url_for('file_analyze', file_id=file_id) }}">
    <h4>What to compute?</h4>

    <div class="row">
      <div class="col-md-6">
        <h5>Structure</h5>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="avg_clustering" id="m_avg_clustering" checked>
          <label class="form-check-label" for="m_avg_clustering">
            Average clustering coefficient
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="transitivity" id="m_transitivity" checked>
          <label class="form-check-label" for="m_transitivity">
            Transitivity
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="avg_shortest_path_length" id="m_aspl">
          <label class="form-check-label" for="m_aspl">
            Average shortest path length (largest CC)
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="diameter" id="m_diameter">
          <label class="form-check-label" for="m_diameter">
            Diameter (largest CC)
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="assortativity_degree" id="m_assortativity">
          <label class="form-check-label" for="m_assortativity">
            Degree assortativity
          </label>
        </div>
      </div>

      <div class="col-md-6">
        <h5>Centralities</h5>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="degree_centrality" id="m_deg_cent" checked>
          <label class="form-check-label" for="m_deg_cent">
            Degree centrality (mean / max)
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="betweenness_centrality" id="m_bet_cent">
          <label class="form-check-label" for="m_bet_cent">
            Betweenness centrality (mean / max, approx on large graphs)
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="closeness_centrality" id="m_clo_cent">
          <label class="form-check-label" for="m_clo_cent">
            Closeness centrality (mean / max)
          </label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="metrics" value="eigenvector_centrality" id="m_eig_cent">
          <label class="form-check-label" for="m_eig_cent">
            Eigenvector centrality (mean / max, may be skipped on large graphs)
          </label>
        </div>
      </div>
    </div>

    <hr>

    <h5>Correlations</h5>
    <div class="form-check mb-3">
      <input class="form-check-input" type="checkbox" name="corr_nodewise" id="corr_nodewise">
      <label class="form-check-label" for="corr_nodewise">
        Compute Pearson correlation between centrality vectors
        (degree vs betweenness vs closeness vs eigenvector)
      </label>
      <div class="form-text">
        For large networks some centralities may be approximated or skipped.
      </div>
    </div>

    <button type="submit" class="btn btn-primary">
      Analyze network
    </button>

    <a href="{{ url_for('popular') if source == 'popular' else url_for('index') }}"
       class="btn btn-secondary ms-2">
      Back
    </a>
  </form>
</div>
{% endblock %}
